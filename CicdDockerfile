FROM gitlab.halfme.com:4567/base-image/nodejs:12.8.1-alpine3.10

EXPOSE 80 8080

WORKDIR /usr/share/nginx/html/project

COPY package.json .
COPY yarn.lock .

RUN yarn install \
    && yarn cache clean

COPY . .

COPY ./docker/nginx.conf /etc/nginx/nginx.conf
COPY ./docker/supervisord.conf /etc/supervisor.d/supervisord.ini

CMD /usr/bin/supervisord -n -c /etc/supervisord.conf;
